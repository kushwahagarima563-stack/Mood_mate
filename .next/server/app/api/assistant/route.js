"use strict";(()=>{var e={};e.id=5410,e.ids=[5410],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},22739:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>A,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>d});var o=r(49303),a=r(88716),n=r(60670),i=r(87070),u=r(16945);let p=(0,r(94738).eI)("https://uhmjdujijoywhyrugplb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVobWpkdWppam95d2h5cnVncGxiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk0MDI3OTQsImV4cCI6MjA3NDk3ODc5NH0.i4_xrI-ZdDaSEgoXgsIrJRl1tPjP7Z-x2byn1KlXKwA");async function d(e){try{let{message:t,sessionId:r}=await e.json();if(!t||!r)return i.NextResponse.json({error:"Message and sessionId are required"},{status:400});let s=await (0,u.k)(t),{data:o,error:a}=await p.rpc("match_messages",{query_embedding:s,match_threshold:.78,match_count:5,session_id:r});if(a)return console.error("Supabase error:",a),i.NextResponse.json({error:"Error fetching similar messages"},{status:500});let n=o.map(e=>({role:e.role,parts:[{text:e.content}]})),d=await (0,u.W)(n,t),l={content:d,role:"model",sessionId:r,embedding:await (0,u.k)(d)},{error:c}=await p.from("messages").insert([{content:t,role:"user",sessionId:r,embedding:s},l]);if(c)return console.error("Supabase insert error:",c),i.NextResponse.json({error:"Error saving messages"},{status:500});return i.NextResponse.json({response:d})}catch(e){return console.error("Error in chat API:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/assistant/route",pathname:"/api/assistant",filename:"route",bundlePath:"app/api/assistant/route"},resolvedPagePath:"C:\\Users\\Garima\\Desktop\\Mood_mate\\app\\api\\assistant\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:m,serverHooks:h}=l,g="/api/assistant/route";function A(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},16945:(e,t,r)=>{r.d(t,{W:()=>a,k:()=>n});var s=r(11258);let o=new s.$D(process.env.GEMINI_API_KEY);async function a(e,t){let r=o.getGenerativeModel({model:"gemini-2.5-flash"}).startChat({history:e,generationConfig:{temperature:.9,topK:1,topP:1,maxOutputTokens:8192},safetySettings:[{category:s.OA.HARM_CATEGORY_HARASSMENT,threshold:s.MN.BLOCK_MEDIUM_AND_ABOVE},{category:s.OA.HARM_CATEGORY_HATE_SPEECH,threshold:s.MN.BLOCK_MEDIUM_AND_ABOVE},{category:s.OA.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:s.MN.BLOCK_MEDIUM_AND_ABOVE},{category:s.OA.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:s.MN.BLOCK_MEDIUM_AND_ABOVE}],systemInstruction:{role:"user",parts:[{text:`
You are MoodMate, an empathetic emotional support companion.
Your goal is to listen deeply, validate feelings, and gently guide the user toward clarity and calm.

Guidelines:
- Be warm, non-judgmental, and supportive.
- Actively listen: reflect or rephrase what the user says to show understanding.
- Validate emotions without minimizing them. Normalize feelings.
- Ask gentle, open-ended questions that encourage self-reflection.
- Offer simple coping strategies, mindfulness practices, or grounding techniques if relevant.
- Encourage but never pressure the user to share more.
- Do not provide medical or diagnostic advice.
- If the user mentions self-harm, suicidal thoughts, or crisis, respond compassionately and suggest reaching out to a professional or a trusted helpline.
- Always prioritize empathy and companionship over solutions.
`}]}}),a=await r.sendMessage(t),n=await a.response;return await n.text()}async function n(e){let t=o.getGenerativeModel({model:"embedding-001"});return(await t.embedContent(e)).embedding.values}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,4738,1258],()=>r(22739));module.exports=s})();